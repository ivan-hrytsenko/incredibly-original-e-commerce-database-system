# Лабораторна робота №4

## Опис SQL-запитів

### Агрегаційні функції та GROUP BY (lab4-aggregate-functions.sql)

* **Загальна статистика продажів**
    * **Що робить:** Обчислює загальну кількість замовлень, виручку, середній чек та вартість найдорожчого замовлення.
    * **Чому:** Це базові метрики (KPI) для будь-якого бізнесу, що дозволяють оцінити масштаб продажів.

* **Кількість товарів у кожній категорії**
    * **Що робить:** Використовує `LEFT JOIN` та `GROUP BY`, щоб порахувати, скільки товарів прив'язано до кожної категорії.
    * **Чому:** Допомагає побачити наповненість каталогу та виявити порожні категорії, які потребують нових надходжень.

* **Фільтрація категорій за середньою ціною (HAVING)**
    * **Що робить:** Обчислює середню ціну товарів у категоріях, де кількість товарів більше одного.
    * **Чому:** Демонструє використання умови `HAVING` для фільтрації результатів, які вже були згруповані.

* **Рейтинг клієнтів за витратами**
    * **Що робить:** Підсумовує всі витрати кожного клієнта та сортує їх від найбільшого до найменшого.
    * **Чому:** Дозволяє виділити сегмент лояльних (VIP) клієнтів для маркетингових акцій.

### Операції об'єднання (lab4-joins.sql)

* **Деталізація замовлень (INNER JOIN)**
    * **Що робить:** З’єднує таблиці замовлень, товарів та позицій замовлення.
    * **Чому:** Демонструє вміння об'єднувати три і більше таблиць для отримання повного звіту про вміст кожного кошика.

* **Клієнти та адреси (LEFT JOIN)**
    * **Що робить:** Виводить список усіх клієнтів та їхні адреси, включаючи тих клієнтів, які ще не вказали адресу.
    * **Чому:** Показує різницю між `INNER` та `LEFT JOIN`, де останній зберігає дані з "лівої" таблиці навіть за відсутності збігів.

* **Повна перевірка відповідності (FULL OUTER JOIN)**
    * **Що робить:** Показує всі зв’язки між товарами та категоріями.
    * **Чому:** Допомагає знайти "аномалії": товари без категорій або категорії без товарів одночасно.

### Підзапити (lab4-subqueries.sql)

* **Відхилення від середньої ціни (Підзапит у SELECT)**
    * **Що робить:** Виводить ціну кожного товару поруч із загальною середньою ціною по магазину.
    * **Чому:** Дозволяє в реальному часі бачити, наскільки дорожчим або дешевшим є конкретний товар відносно середнього показника.

* **Пошук "великих" покупців (Підзапит у WHERE)**
    * **Що робить:** Вибирає клієнтів, які робили замовлення на суму, що перевищує середній показник.
    * **Чому:** Приклад використання вкладеного запиту для динамічної фільтрації даних.

* **Бюджетні категорії (Підзапит у HAVING)**
    * **Що робить:** Порівнює середню ціну товарів кожної окремої категорії із загальною середньою ціною всіх товарів у магазині. Виводить лише ті категорії, де середній чек нижчий за загальноринковий.
    * **Чому:** Це дозволяє бізнесу ідентифікувати доступні (бюджетні) сегменти товарів. Використання підзапиту всередині `HAVING` робить фільтрацію динамічною: якщо ціни в магазині зміняться, запит автоматично підлаштується під нове середнє значення.