# Лабораторна робота №2

## Опис остаточної схеми

На основі розробленої ER-діаграми була реалізована база даних для системи електронної комерції. Схема складається з 7 взаємопов'язаних таблиць, які забезпечують зберігання даних про товари, клієнтів та їх замовлення.

### Перелік таблиць та ключів:

* **categories**: Зберігає дерево категорій товарів.
    * `category_id` (Primary Key)
* **products**: Містить детальну інформацію про товари (назва, опис, ціна, залишок).
    * `product_id` (Primary Key)
* **product_categories**: Асоціативна сутність для реалізації зв'язку **багато-до-багатьох** між товарами та категоріями.
    * `product_id` (Foreign Key -> products)
    * `category_id` (Foreign Key -> categories)
    * *Комбінований Primary Key:* `(product_id, category_id)`
* **customers**: Дані про зареєстрованих користувачів.
    * `customer_id` (Primary Key)
* **addresses**: Зберігає декілька адрес для кожного клієнта (зв'язок **один-до-багатьох**).
    * `address_id` (Primary Key)
    * `customer_id` (Foreign Key -> customers)
* **orders**: Головна таблиця замовлень, що пов'язує покупця та адресу доставки.
    * `order_id` (Primary Key)
    * `customer_id` (Foreign Key -> customers)
    * `address_id` (Foreign Key -> addresses)
* **order_items**: Асоціативна сутність для товарів у замовленні (деталізація чеку).
    * `order_id` (Foreign Key -> orders)
    * `product_id` (Foreign Key -> products)
    * *Комбінований Primary Key:* `(order_id, product_id)`

## Важливі обмеження та припущення

1.  **Обмеження унікальності (UNIQUE):** Поле `email` у таблиці `customers` є унікальним, що запобігає повторній реєстрації на одну пошту.
2.  **Обов'язкові поля (NOT NULL):** Критичні дані (імена клієнтів, назви товарів, ціни) позначені як `NOT NULL`.
3.  **Логічна перевірка (CHECK):** * В таблиці `order_items` кількість товарів (`quantity`) обов'язково має бути більшою за 0.
    * Ціна товару в таблиці `products` завжди повинна бути позитивною.
4.  **Поведінка при видаленні (ON DELETE):**
    * Використано `CASCADE` для адрес та позицій замовлення: якщо видаляється головний об'єкт (клієнт або замовлення), пов'язані деталі видаляються автоматично.
    * Використано `SET NULL` у таблиці `orders` для посилань на клієнта та адресу. Це дозволяє зберегти фінансову історію замовлень, навіть якщо акаунт клієнта був видалений.
5.  **Фіксація ціни:** В таблиці `order_items` додано поле `unit_price`, яке зберігає ціну товару *на момент покупки*. Це дозволяє змінювати ціни в каталозі `products` без викривлення звітності за минулі періоди.