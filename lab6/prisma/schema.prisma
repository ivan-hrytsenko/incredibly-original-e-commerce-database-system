generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model addresses {
  address_id   Int        @id @default(autoincrement())
  street       String     @db.VarChar(255)
  house_number String     @db.VarChar(20)
  zip_code     String?    @db.VarChar(20)
  customer_id  Int?
  customers    customers? @relation(fields: [customer_id], references: [customer_id], onDelete: Cascade, onUpdate: NoAction)
  zip_codes    zip_codes? @relation(fields: [zip_code], references: [zip_code], onDelete: NoAction, onUpdate: NoAction, map: "fk_address_zip")
  orders       orders[]
}

model categories {
  category_id        Int                  @id @default(autoincrement())
  title              String               @db.VarChar(255)
  description        String?
  product_categories product_categories[]
}

model customers {
  customer_id Int         @id @default(autoincrement())
  first_name  String      @db.VarChar(100)
  last_name   String      @db.VarChar(100)
  email       String      @unique @db.VarChar(150)
  phone       String?     @db.VarChar(20)
  created_at  DateTime?   @default(now()) @db.Timestamp(6)
  addresses   addresses[]
  orders      orders[]
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model order_items {
  order_id   Int
  product_id Int
  quantity   Int
  unit_price Decimal  @db.Decimal(10, 2)
  orders     orders   @relation(fields: [order_id], references: [order_id], onDelete: Cascade, onUpdate: NoAction)
  products   products @relation(fields: [product_id], references: [product_id], onDelete: Cascade, onUpdate: NoAction)

  @@id([order_id, product_id])
}

model orders {
  order_id     Int           @id @default(autoincrement())
  order_date   DateTime?     @default(now()) @db.Timestamp(6)
  status       String?       @db.VarChar(50)
  total_amount Decimal?      @db.Decimal(12, 2)
  customer_id  Int?
  address_id   Int?
  order_items  order_items[]
  addresses    addresses?    @relation(fields: [address_id], references: [address_id], onUpdate: NoAction)
  customers    customers?    @relation(fields: [customer_id], references: [customer_id], onUpdate: NoAction)
}

model product_categories {
  product_id  Int
  category_id Int
  categories  categories @relation(fields: [category_id], references: [category_id], onDelete: Cascade, onUpdate: NoAction)
  products    products   @relation(fields: [product_id], references: [product_id], onDelete: Cascade, onUpdate: NoAction)

  @@id([product_id, category_id])
}

model products {
  product_id         Int                  @id @default(autoincrement())
  name               String               @db.VarChar(255)
  description        String?
  price              Decimal              @db.Decimal(10, 2)
  stock_quantity     Int?                 @default(0)
  is_active          Boolean              @default(true)
  order_items        order_items[]
  product_categories product_categories[]
  reviews            reviews[]
}

model zip_codes {
  zip_code  String      @id @db.VarChar(20)
  city      String      @db.VarChar(100)
  addresses addresses[]
}

model reviews {
  review_id  Int      @id @default(autoincrement())
  rating     Int
  comment    String?
  created_at DateTime @default(now()) @db.Timestamp(6)
  product_id Int
  products   products @relation(fields: [product_id], references: [product_id], onDelete: Cascade)
}